<%=

require 'json'

def get_geoid_map
  # 'Table of Geographical Locations (Windows)'
  #   http://msdn.microsoft.com/en-us/library/windows/desktop/dd374073(v=vs.86).aspx
  <<-eos
  {
    "2": "Antigua and Barbuda",
    "3": "Afghanistan",
    "4": "Algeria",
    "5": "Azerbaijan",
    "6": "Albania",
    "7": "Armenia",
    "8": "Andorra",
    "9": "Angola",
    "10": "American Samoa",
    "11": "Argentina",
    "12": "Australia",
    "14": "Austria",
    "17": "Bahrain",
    "18": "Barbados",
    "19": "Botswana",
    "20": "Bermuda",
    "21": "Belgium",
    "22": "Bahamas",
    "23": "Bangladesh",
    "24": "Belize",
    "25": "Bosnia and Herzegovina",
    "26": "Bolivia",
    "27": "Myanmar",
    "28": "Benin",
    "29": "Belarus",
    "30": "Solomon Islands",
    "32": "Brazil",
    "34": "Bhutan",
    "35": "Bulgaria",
    "37": "Brunei",
    "38": "Burundi",
    "39": "Canada",
    "40": "Cambodia",
    "41": "Chad",
    "42": "Sri Lanka",
    "43": "Congo",
    "44": "Congo (DRC)",
    "45": "China",
    "46": "Chile",
    "49": "Cameroon",
    "50": "Comoros",
    "51": "Colombia",
    "54": "Costa Rica",
    "55": "Central African Republic",
    "56": "Cuba",
    "57": "Cape Verde",
    "59": "Cyprus",
    "61": "Denmark",
    "62": "Djibouti",
    "63": "Dominica",
    "65": "Dominican Republic",
    "66": "Ecuador",
    "67": "Egypt",
    "68": "Ireland",
    "69": "Equatorial Guinea",
    "70": "Estonia",
    "71": "Eritrea",
    "72": "El Salvador",
    "73": "Ethiopia",
    "75": "Czech Republic",
    "77": "Finland",
    "78": "Fiji Islands",
    "80": "Micronesia",
    "81": "Faroe Islands",
    "84": "France",
    "86": "Gambia",
    "87": "Gabon",
    "88": "Georgia",
    "89": "Ghana",
    "90": "Gibraltar",
    "91": "Grenada",
    "93": "Greenland",
    "94": "Germany",
    "98": "Greece",
    "99": "Guatemala",
    "100": "Guinea",
    "101": "Guyana",
    "103": "Haiti",
    "104": "Hong Kong S.A.R.",
    "106": "Honduras",
    "108": "Croatia",
    "109": "Hungary",
    "110": "Iceland",
    "111": "Indonesia",
    "113": "India",
    "114": "British Indian Ocean Territory",
    "116": "Iran",
    "117": "Israel",
    "118": "Italy",
    "119": "Côte d'Ivoire",
    "121": "Iraq",
    "122": "Japan",
    "124": "Jamaica",
    "125": "Jan Mayen",
    "126": "Jordan",
    "127": "Johnston Atoll",
    "129": "Kenya",
    "130": "Kyrgyzstan",
    "131": "North Korea",
    "133": "Kiribati",
    "134": "Korea",
    "136": "Kuwait",
    "137": "Kazakhstan",
    "138": "Laos",
    "139": "Lebanon",
    "140": "Latvia",
    "141": "Lithuania",
    "142": "Liberia",
    "143": "Slovakia",
    "145": "Liechtenstein",
    "146": "Lesotho",
    "147": "Luxembourg",
    "148": "Libya",
    "149": "Madagascar",
    "151": "Macao S.A.R.",
    "152": "Moldova",
    "154": "Mongolia",
    "156": "Malawi",
    "157": "Mali",
    "158": "Monaco",
    "159": "Morocco",
    "160": "Mauritius",
    "162": "Mauritania",
    "163": "Malta",
    "164": "Oman",
    "165": "Maldives",
    "166": "Mexico",
    "167": "Malaysia",
    "168": "Mozambique",
    "173": "Niger",
    "174": "Vanuatu",
    "175": "Nigeria",
    "176": "Netherlands",
    "177": "Norway",
    "178": "Nepal",
    "180": "Nauru",
    "181": "Suriname",
    "182": "Nicaragua",
    "183": "New Zealand",
    "184": "Palestinian Authority",
    "185": "Paraguay",
    "187": "Peru",
    "190": "Pakistan",
    "191": "Poland",
    "192": "Panama",
    "193": "Portugal",
    "194": "Papua New Guinea",
    "195": "Palau",
    "196": "Guinea-Bissau",
    "197": "Qatar",
    "198": "Reunion",
    "199": "Marshall Islands",
    "200": "Romania",
    "201": "Philippines",
    "202": "Puerto Rico",
    "203": "Russia",
    "204": "Rwanda",
    "205": "Saudi Arabia",
    "206": "St. Pierre and Miquelon",
    "207": "St. Kitts and Nevis",
    "208": "Seychelles",
    "209": "South Africa",
    "210": "Senegal",
    "212": "Slovenia",
    "213": "Sierra Leone",
    "214": "San Marino",
    "215": "Singapore",
    "216": "Somalia",
    "217": "Spain",
    "218": "St. Lucia",
    "219": "Sudan",
    "220": "Svalbard",
    "221": "Sweden",
    "222": "Syria",
    "223": "Switzerland",
    "224": "United Arab Emirates",
    "225": "Trinidad and Tobago",
    "227": "Thailand",
    "228": "Tajikistan",
    "231": "Tonga",
    "232": "Togo",
    "233": "São Tomé and Príncipe",
    "234": "Tunisia",
    "235": "Turkey",
    "236": "Tuvalu",
    "237": "Taiwan",
    "238": "Turkmenistan",
    "239": "Tanzania",
    "240": "Uganda",
    "241": "Ukraine",
    "242": "United Kingdom",
    "244": "United States",
    "245": "Burkina Faso",
    "246": "Uruguay",
    "247": "Uzbekistan",
    "248": "St. Vincent and the Grenadines",
    "249": "Venezuela",
    "251": "Vietnam",
    "252": "Virgin Islands",
    "253": "Vatican City",
    "254": "Namibia",
    "257": "Western Sahara (disputed)",
    "258": "Wake Island",
    "259": "Samoa",
    "260": "Swaziland",
    "261": "Yemen",
    "263": "Zambia",
    "264": "Zimbabwe",
    "269": "Serbia and Montenegro (Former)",
    "270": "Montenegro",
    "271": "Serbia",
    "273": "Curaçao",
    "276": "South Sudan",
    "300": "Anguilla",
    "301": "Antarctica",
    "302": "Aruba",
    "303": "Ascension Island",
    "304": "Ashmore and Cartier Islands",
    "305": "Baker Island",
    "306": "Bouvet Island",
    "307": "Cayman Islands",
    "309": "Christmas Island",
    "310": "Clipperton Island",
    "311": "Cocos (Keeling) Islands",
    "312": "Cook Islands",
    "313": "Coral Sea Islands",
    "314": "Diego Garcia",
    "315": "Falkland Islands (Islas Malvinas)",
    "317": "French Guiana",
    "318": "French Polynesia",
    "319": "French Southern and Antarctic Lands",
    "321": "Guadeloupe",
    "322": "Guam",
    "323": "Guantanamo Bay",
    "324": "Guernsey",
    "325": "Heard Island and McDonald Islands",
    "326": "Howland Island",
    "327": "Jarvis Island",
    "328": "Jersey",
    "329": "Kingman Reef",
    "330": "Martinique",
    "331": "Mayotte",
    "332": "Montserrat",
    "334": "New Caledonia",
    "335": "Niue",
    "336": "Norfolk Island",
    "337": "Northern Mariana Islands",
    "338": "Palmyra Atoll",
    "339": "Pitcairn Islands",
    "340": "Rota Island",
    "341": "Saipan",
    "342": "South Georgia and the South Sandwich Islands",
    "343": "St. Helena",
    "346": "Tinian Island",
    "347": "Tokelau",
    "348": "Tristan da Cunha",
    "349": "Turks and Caicos Islands",
    "351": "Virgin Islands",
    "352": "Wallis and Futuna",
    "15126"      : "Man",
    "19618"      : "Macedonia",
    "21242"      : "Midway Islands",
    "30967"      : "Sint Maarten (Dutch part)",
    "31706"      : "Saint Martin (French part)",
    "7299303"    : "Democratic Republic of Timor-Leste",
    "10028789"   : "Åland Islands",
    "161832015"  : "Saint Barthélemy",
    "161832256"  : "U.S. Minor Outlying Islands",
    "161832258"  : "Bonaire, Saint Eustatius and Saba"
  }
eos
end

def get_geoid_from_country(country)
  geoids = JSON.parse( get_geoid_map )
  keys = (geoids.select { |k| ! (geoids[k].to_s =~ /#{country}/i).nil? }).keys
  if keys.length == 1; return keys[0]; end
  keys
end

def get_country_from_geoid(geoid)
  geoids = JSON.parse( get_geoid_map )
  geoids[geoid]
end

# puts get_country_from_geoid( ARGV[0] )
%>
