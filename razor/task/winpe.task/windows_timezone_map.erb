<%=
require 'json'

def get_timezone_map
  # 'Windows Language Pack Default Values - Default Time zones'
  #   http://technet.microsoft.com/en-gb/library/hh825682.aspx
  <<-eos
  {
    "Afghanistan": "Afghanistan Standard Time",
    "Albania": "Central European Standard Time",
    "Algeria": "W. Central Africa Standard Time",
    "American Samoa": "Samoa Standard Time",
    "Andorra": "Romance Standard Time",
    "Angola": "W. Central Africa Standard Time",
    "Anguilla": "SA Western Standard Time",
    "Antarctica": "GMT Standard Time",
    "Antigua and Barbuda": "SA Western Standard Time",
    "Argentina": "Argentina Standard Time",
    "Armenia": "Caucasus Standard Time",
    "Aruba": "SA Western Standard Time",
    "Ashmore and Cartier Islands": "W. Australia Standard Time",
    "Australia": "AUS Eastern Standard Time",
    "Austria": "W. Europe Standard Time",
    "Azerbaijan": "Azerbaijan Standard Time",
    "Bahamas, The": "Eastern Standard Time",
    "Bahrain": "Arab Standard Time",
    "Baker Island": "Dateline Standard Time",
    "Bangladesh": "Central Asia Standard Time",
    "Barbados": "SA Western Standard Time",
    "Belarus": "E. Europe Standard Time",
    "Belgium": "Romance Standard Time",
    "Belize": "Central America Standard Time",
    "Benin": "W. Central Africa Standard Time",
    "Bermuda": "SA Western Standard Time",
    "Bhutan": "Central Asia Standard Time",
    "Bolivia": "SA Western Standard Time",
    "Bosnia and Herzegovina": "Central European Standard Time",
    "Botswana": "South Africa Standard Time",
    "Bouvet Island": "W. Central Africa Standard Time",
    "Brazil": "E. South America Standard Time",
    "British Indian Ocean Territory": "Central Asia Standard Time",
    "Brunei": "Singapore Standard Time",
    "Bulgaria": "FLE Standard Time",
    "Burkina Faso": "Greenwich Standard Time",
    "Burundi": "South Africa Standard Time",
    "Cambodia": "SE Asia Standard Time",
    "Cameroon": "W. Central Africa Standard Time",
    "Canada": "Eastern Standard Time",
    "Cape Verde": "Cape Verde Standard Time",
    "Cayman Islands": "SA Pacific Standard Time",
    "Central African Republic": "W. Central Africa Standard Time",
    "Chad": "W. Central Africa Standard Time",
    "Channel Islands": "GMT Standard Time",
    "Chile": "Pacific SA Standard Time",
    "China": "China Standard Time",
    "Christmas Island": "SE Asia Standard Time",
    "Clipperton Island": "US Mountain Standard Time",
    "Cocos (Keeling) Islands": "SE Asia Standard Time",
    "Colombia": "SA Pacific Standard Time",
    "Comoros": "E. Africa Standard Time",
    "Congo": "W. Central Africa Standard Time",
    "Congo (DRC)": "W. Central Africa Standard Time",
    "Cook Islands": "Hawaiian Standard Time",
    "Coral Sea Islands": "E. Australia Standard Time",
    "Costa Rica": "Central America Standard Time",
    "Croatia": "Central European Standard Time",
    "Cuba": "SA Pacific Standard Time",
    "Cyprus": "GTB Standard Time",
    "Czech Republic": "Central Europe Standard Time",
    "Côte d'Ivoire": "Greenwich Standard Time",
    "Denmark": "Romance Standard Time",
    "Diego Garcia": "Central Asia Standard Time",
    "Djibouti": "E. Africa Standard Time",
    "Dominica": "SA Western Standard Time",
    "Dominican Republic": "SA Western Standard Time",
    "Ecuador": "SA Pacific Standard Time",
    "Egypt": "Egypt Standard Time",
    "El Salvador": "Central America Standard Time",
    "Equatorial Guinea": "W. Central Africa Standard Time",
    "Eritrea": "E. Africa Standard Time",
    "Estonia": "FLE Standard Time",
    "Ethiopia": "E. Africa Standard Time",
    "Falkland Islands (Islas Malvinas)": "Atlantic Standard Time",
    "Faroe Islands": "GMT Standard Time",
    "Fiji Islands": "Fiji Standard Time",
    "Finland": "FLE Standard Time",
    "France": "Romance Standard Time",
    "French Guiana": "SA Eastern Standard Time",
    "French Polynesia": "West Pacific Standard Time",
    "French Southern and Antarctic Lands": "Arabian Standard Time",
    "Gabon": "W. Central Africa Standard Time",
    "Gambia, The": "Greenwich Standard Time",
    "Georgia": "Georgian Standard Time",
    "Germany": "W. Europe Standard Time",
    "Ghana": "Greenwich Standard Time",
    "Gibraltar": "W. Europe Standard Time",
    "Greece": "GTB Standard Time",
    "Greenland": "Greenland Standard Time",
    "Grenada": "SA Western Standard Time",
    "Guadeloupe": "SA Western Standard Time",
    "Guam": "West Pacific Standard Time",
    "Guantanamo Bay": "Eastern Standard Time",
    "Guatemala": "Central America Standard Time",
    "Guernsey": "GMT Standard Time",
    "Guinea": "Greenwich Standard Time",
    "Guinea-Bissau": "Greenwich Standard Time",
    "Guyana": "SA Western Standard Time",
    "Haiti": "Eastern Standard Time",
    "Heard Island and McDonald Islands": "Arabian Standard Time",
    "Honduras": "Central America Standard Time",
    "Hong Kong SAR": "China Standard Time",
    "Howland Island": "Samoa Standard Time",
    "Hungary": "Central Europe Standard Time",
    "Iceland": "Greenwich Standard Time",
    "India": "India Standard Time",
    "Indonesia": "SE Asia Standard Time",
    "Iran": "Iran Standard Time",
    "Iraq": "Arabic Standard Time",
    "Ireland": "GMT Standard Time",
    "Isle of Man": "GMT Standard Time",
    "Israel": "Israel Standard Time",
    "Italy": "W. Europe Standard Time",
    "Jamaica": "SA Pacific Standard Time",
    "Jan Mayen": "W. Europe Standard Time",
    "Japan": "Tokyo Standard Time",
    "Jarvis Island": "Samoa Standard Time",
    "Jersey": "GMT Standard Time",
    "Johnston Atoll": "Samoa Standard Time",
    "Jordan": "Jordan Standard Time",
    "Kazakhstan": "Central Asia Standard Time",
    "Kenya": "E. Africa Standard Time",
    "Kingman Reef": "Samoa Standard Time",
    "Kiribati": "Tonga Standard Time",
    "Korea": "Korea Standard Time",
    "Kuwait": "Arab Standard Time",
    "Kyrgyzstan": "Central Asia Standard Time",
    "Laos": "SE Asia Standard Time",
    "Latvia": "FLE Standard Time",
    "Lebanon": "Middle East Standard Time",
    "Lesotho": "South Africa Standard Time",
    "Liberia": "Greenwich Standard Time",
    "Libya": "South Africa Standard Time",
    "Liechtenstein": "W. Europe Standard Time",
    "Lithuania": "FLE Standard Time",
    "Luxembourg": "W. Europe Standard Time",
    "Macao SAR": "China Standard Time",
    "Macedonia, FYROM": "W. Europe Standard Time",
    "Madagascar": "E. Africa Standard Time",
    "Malawi": "South Africa Standard Time",
    "Malaysia": "Singapore Standard Time",
    "Maldives": "West Asia Standard Time",
    "Mali": "Greenwich Standard Time",
    "Malta": "W. Europe Standard Time",
    "Marshall Islands": "Fiji Standard Time",
    "Martinique": "SA Western Standard Time",
    "Mauritania": "Greenwich Standard Time",
    "Mauritius": "Mauritius Standard Time",
    "Mayotte": "E. Africa Standard Time",
    "Mexico": "Central Standard Time (Mexico)",
    "Micronesia": "Fiji Standard Time",
    "Midway Islands": "Samoa Standard Time",
    "Moldova": "FLE Standard Time",
    "Monaco": "W. Europe Standard Time",
    "Mongolia": "North Asia East Standard Time",
    "Montserrat": "SA Western Standard Time",
    "Morocco": "Greenwich Standard Time",
    "Mozambique": "South Africa Standard Time",
    "Myanmar": "Myanmar Standard Time",
    "Namibia": "Namibia Standard Time",
    "Nauru": "Fiji Standard Time",
    "Nepal": "Nepal Standard Time",
    "Netherlands": "W. Europe Standard Time",
    "Netherlands Antilles": "SA Western Standard Time",
    "New Caledonia": "Central Pacific Standard Time",
    "New Zealand": "New Zealand Standard Time",
    "Nicaragua": "Central America Standard Time",
    "Niger": "W. Central Africa Standard Time",
    "Nigeria": "W. Central Africa Standard Time",
    "Niue": "Samoa Standard Time",
    "Norfolk Island": "Central Pacific Standard Time",
    "North Korea": "Tokyo Standard Time",
    "Northern Mariana Islands": "West Pacific Standard Time",
    "Norway": "W. Europe Standard Time",
    "Oman": "Arabian Standard Time",
    "Pakistan": "Pakistan Standard Time",
    "Palau": "Tokyo Standard Time",
    "Palestinian Authority": "GTB Standard Time",
    "Palmyra Atoll": "Samoa Standard Time",
    "Panama": "SA Pacific Standard Time",
    "Papua New Guinea": "West Pacific Standard Time",
    "Paraguay": "SA Pacific Standard Time",
    "Peru": "SA Pacific Standard Time",
    "Philippines": "China Standard Time",
    "Pitcairn Islands": "Pacific Standard Time",
    "Poland": "Central European Standard Time",
    "Portugal": "GMT Standard Time",
    "Puerto Rico": "SA Western Standard Time",
    "Qatar": "Arab Standard Time",
    "Reunion": "Arabian Standard Time",
    "Romania": "GTB Standard Time",
    "Rota Island": "West Pacific Standard Time",
    "Russia": "Russian Standard Time",
    "Rwanda": "South Africa Standard Time",
    "Saint Helena, Ascension, Tristan da Cunha": "GMT Standard Time",
    "Saipan": "West Pacific Standard Time",
    "Samoa": "Samoa Standard Time",
    "San Marino": "W. Europe Standard Time",
    "Saudi Arabia": "Arab Standard Time",
    "Senegal": "Greenwich Standard Time",
    "Serbia": "Central Europe Standard Time",
    "Seychelles": "Arabian Standard Time",
    "Sierra Leone": "Greenwich Standard Time",
    "Singapore": "Singapore Standard Time",
    "Slovakia": "Central Europe Standard Time",
    "Slovenia": "Central Europe Standard Time",
    "Solomon Islands": "Central Pacific Standard Time",
    "Somalia": "E. Africa Standard Time",
    "South Africa": "South Africa Standard Time",
    "South Georgia and the South Sandwich Islands": "Mid-Atlantic Standard Time",
    "Spain": "Romance Standard Time",
    "Sri Lanka": "Sri Lanka Standard Time",
    "St. Helena": "Greenwich Standard Time",
    "St. Kitts and Nevis": "SA Western Standard Time",
    "St. Lucia": "SA Western Standard Time",
    "St. Pierre and Miquelon": "SA Eastern Standard Time",
    "St. Vincent and the Grenadines": "SA Western Standard Time",
    "Sudan": "E. Africa Standard Time",
    "Suriname": "SA Eastern Standard Time",
    "Svalbard": "W. Europe Standard Time",
    "Swaziland": "South Africa Standard Time",
    "Sweden": "W. Europe Standard Time",
    "Switzerland": "W. Europe Standard Time",
    "Syria": "South Africa Standard Time",
    "São Tomé and Príncipe": "Greenwich Standard Time",
    "Taiwan": "Taipei Standard Time",
    "Tajikistan": "West Asia Standard Time",
    "Tanzania": "E. Africa Standard Time",
    "Thailand": "SE Asia Standard Time",
    "Timor-Leste": "Tokyo Standard Tim",
    "Tinian Island": "West Pacific Standard Time",
    "Togo": "Greenwich Standard Time",
    "Tokelau": "Hawaiian Standard Time",
    "Tonga": "Tonga Standard Time",
    "Trinidad and Tobago": "SA Western Standard Time",
    "Tristan da Cunha": "Greenwich Standard Time",
    "Tunisia": "W. Europe Standard Time",
    "Turkey": "Turkey Standard Time",
    "Turkmenistan": "West Asia Standard Time",
    "Turks and Caicos Islands": "SA Pacific Standard Time",
    "Tuvalu": "Fiji Standard Time",
    "Uganda": "E. Africa Standard Time",
    "Ukraine": "FLE Standard Time",
    "United Arab Emirates": "Arabian Standard Time",
    "United Kingdom": "GMT Standard Time",
    "United States": "Pacific Standard Time",
    "Uruguay": "SA Eastern Standard Time",
    "Uzbekistan": "West Asia Standard Time",
    "Vanuatu": "Central Pacific Standard Time",
    "Vatican City": "W. Europe Standard Time",
    "Venezuela": "Venezuela Standard Time",
    "Vietnam": "SE Asia Standard Time",
    "Virgin Islands": "SA Western Standard Time",
    "Virgin Islands, British": "SA Western Standard Time",
    "Wake Island": "Fiji Standard Time",
    "Wallis and Futuna": "Fiji Standard Time",
    "Yemen": "E. Africa Standard Time",
    "Zambia": "South Africa Standard Time",
    "Zimbabwe": "South Africa Standard Time"
  }
eos
end

def get_timezone_for_country(country)
  timezones = JSON.parse( get_timezone_map )
  if (values=(res = timezones.select { |k,v| !(k =~ /#{country}/i).nil? }).values).length >= 1
    [ res.values ]
  else
    raise "Found '#{values.length}' candidates found for country '#{country}' [%s]" % res.collect{ |k,v| v }.join(",")
  end
end

# puts get_timezone_for_country( ARGV[0] )
%>
